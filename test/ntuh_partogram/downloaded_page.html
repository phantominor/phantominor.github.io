
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    
    <title>
        正式環境(Portal)介面
    </title>
    <link href="css/login.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="scripts/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="scripts/Utils.js?version=20250311"></script>
    
    <script type="text/javascript" src="scripts/verify.js?version=20250311"></script>
    <LINK href="css/portal.css" type="text/css" rel="stylesheet">
    <script type="text/javascript">

        function PostData(CardID) {
            //document.write('<form id=myForm >');   
            //document.write('<input type="hidden" id="CardID" name="CardID" />'); 
            var myForm = document.forms['Form1'];
            myForm.CardID.value = CardID;
            myForm.action = "";
            myForm.method = 'POST';
            myForm.submit();
        }

        function isMobile() {
            try {
                document.createEvent("TouchEvent");
                return true;
            } catch (e) {
                return false;
            }
        }

        function InitInPatientConsentQuickMenu() {

            if (isMobile()) {
                $("#hidIsMobile").val("Y");
            }

            document.getElementById("btnInitInPatientConsentQuickMenu").click();
        }

        //以下寫法因為沒有經過.NET元件產生會抓不到SelectedValue
        //function InitInPatientConsentQuickMenu() {

        //    var rdblQuickMenu = document.getElementById("rdblQuickMenu");
        //    var rowcount = rdblQuickMenu.getElementsByTagName("tr").length;
        //    var row = rdblQuickMenu.insertRow(rowcount);

        //    var cell = row.insertCell(0);

        //    cell.innerHTML = "<INPUT name='rdblQuickMenu' tabIndex='97' id='rdblQuickMenu_" + rowcount + "' type='radio' value='II'><LABEL for='rdblQuickMenu_" + rowcount + "'>住院同意書簽署2</LABEL>"

        //}
    </script>

    <style type="text/css">
        BODY {
            MARGIN-TOP: 0px;
            MARGIN-LEFT: 0px;
        }

        .link4 {
            LINE-HEIGHT: 16px;
            FONT-FAMILY: 'Noto Sans TC', Arial, 'Microsoft JhengHei', Droid Sans, Helvetica, 'Heiti TC', sans-serif;
            COLOR: #736d56;
            FONT-SIZE: 12px;
        }

            .link4 A {
                LINE-HEIGHT: 16px;
                FONT-FAMILY: 'Noto Sans TC', Arial, 'Microsoft JhengHei', Droid Sans, Helvetica, 'Heiti TC', sans-serif;
                COLOR: #736d56;
                FONT-SIZE: 12px;
                TEXT-DECORATION: none;
            }

                .link4 A:hover {
                    FONT-FAMILY: 'Noto Sans TC', Arial, 'Microsoft JhengHei', Droid Sans, Helvetica, 'Heiti TC', sans-serif;
                    COLOR: #a8a28c;
                    FONT-SIZE: 12px;
                    FONT-WEIGHT: normal;
                }

        #navi {
            position: absolute;
        }

            #navi ul {
                margin: 0;
                padding: 0;
                list-style-type: none;
                font-size: 12px;
            }

            #navi li {
                float: left;
                width: 65px;
                margin: 0;
            }

                #navi li a {
                    display: block;
                    padding: 3px;
                    text-align: center;
                    font-family: 'Noto Sans TC', Arial, 'Microsoft JhengHei', Droid Sans, Helvetica, 'Heiti TC', sans-serif;
                    color: #736d56;
                    text-decoration: none;
                }

                    #navi li a:hover {
                        display: block;
                        text-align: center;
                        font-family: 'Noto Sans TC', Arial, 'Microsoft JhengHei', Droid Sans, Helvetica, 'Heiti TC', sans-serif;
                        color: #a8a28c;
                    }

            #navi ul ul {
                background: #b6cebc;
            }

                #navi ul ul li {
                    float: none;
                }

                    #navi ul ul li a {
                        border-top: 1px solid #ffffff;
                        background: none;
                        font-size: 12px;
                        text-decoration: none;
                        color: #666;
                        line-height: 15px;
                    }

                        #navi ul ul li a:hover {
                            color: #ffffff;
                            background-image: none;
                            background-color: #F60;
                        }

            #navi ul li.parent ul {
                display: none;
            }

            #navi ul li.parentOn ul {
                display: block;
            }

        .btn {
            border: none;
            background: url(images/LogIn.gif) no-repeat center;
            background-color: white;
            background-size: auto;
            background-size: cover;
            -ms-behavior: url(images/LogIn.gif);
        }

        .button-line {
            display: block;
        }

        .reg-button {
            display: inline-block;
            margin-top: 10px;
            font-size: 12px;
            text-decoration: none;
            color: #FFF;
            background-color: #807a65;
            padding: 4px 12px;
            border-radius: 4px;
        }

            .reg-button:hover {
                background-color: #726d5d;
            }
        /**/
    </style>
    <meta http-equiv="Content-Type" content="text/html" />
</head>
<body ms_positioning="GridLayout">

    <form name="Form1" method="post" action="./Login.aspx?URL=http%3a%2f%2frhisaw.ntuh.gov.tw%2fWebApplication%2fWebEforms%2fWriteEforms.aspx" id="Form1">
<div>
<input type="hidden" name="ScriptManager1_HiddenField" id="ScriptManager1_HiddenField" value="" />
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__LASTFOCUS" id="__LASTFOCUS" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="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" />
</div>

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['Form1'];
if (!theForm) {
    theForm = document.Form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>


<script src="/General/WebResource.axd?d=ebq6WzWyT9Xqs6hkFfBKD2FhqTvLbWsXkGYaaHstdyAbtRgP01OHPxdjHV7Id4hpZFc-ZdOfoaLBKO7cah3qGDiQgN0PEQddTnnSXtGQudA1&amp;t=638628495619783110" type="text/javascript"></script>


<script src="/General/ScriptResource.axd?d=cM7MbVRTK5L2cx0aH-aKj9oeybUs4lvG1A30U12I81cgYjK0dYPJ7t3g6OMyoLKD2jpVZaLD74fle4EM2XGKJ6g8UUSVXC1Y2wc92gyYbCyAbsrwBZNomLfB3FLiUe2H0&amp;t=ffffffffb0c7e276" type="text/javascript"></script>
<script src="/General/ScriptResource.axd?d=IcUv3ooXyHOj4j95wdUuKY7Bq0DfpeHtmTh243iPOqWAs0PHXYBKnIyYTO-36ya-lRTpfzDabcbt06TuX9nuu8VvWG9DwKcvZBfkLoufO074RpyAv3iHstOkvOghJj6eSiiP1hXqyxTSQXi9eN8WSQ2&amp;t=ffffffffb0c7e276" type="text/javascript"></script>
<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="B41D256E" />
	<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAB9PzjD7jPQuOS5UhimxGIM4us6f3DnhO7vgNC7jgL0JUTumnf8wnXPF3yZ1bsutqrR6EtBk7YJGjv5e2aYKqyTcE+kUuxEaoJt51T4ChYL1OT3px3tgEIK4muDn+c2yzIYLpAe3mXbxZrztQmQyieA6grde1kF3NR9299zTlS9dzNLoN8lBp/4e7DzpkKqQUZ1jNeCExJY89buUbZ9FRGRDcHu9wU3XwubjWgD7k4xdHYWcA+2AavvfRgNPmT62DAvxExokW0vhhxLKtEbhelTt9Tt6KoVd96dN6zOjIKoOlEPTPkdPWl+8YN2NtDCtxieoshJs7mHVRYwWliu8eZA1Hns1YU9+PijixkcV6QJ2XvsGLD9XTqB84fMjyCudHzorK+sIWgqh0eXKvqG1dIqNQ4Lmyp7k5oxKieilw7ujlxA27Vs2YbNHpHJgboS0KG34RB4PvkDhmXVPNstG/BVm9k2M8EMBz57EWuxQ3gtJREhZBV2Qu3I4X7NXv1tik9/ZVsN61creiAMbp5Vlsg4THm3B0ka42rVWStXg2DfPxUvxhPd9/wi8n8SdCarKeIcCrOoNPAbgtuSHd3c2W/529P+KllhVTbUSCnA6p1lh+P9wHQ4/irfiYPlpl76bgZxxVHxbawdDW8im+3xvCESCb2pzKou1idmjs974fJqKn4gMQtBvyujr7MwJa3dAgpE=" />
</div>
        <div align="center">
            <script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('ScriptManager1', 'Form1', [], [], [], 90, '');
//]]>
</script>

            <input id="CardID" type="hidden" name="CardID" />
            <input name="hidIsMobile" type="hidden" id="hidIsMobile" />
            <input type="submit" name="btnInitInPatientConsentQuickMenu" value="" id="btnInitInPatientConsentQuickMenu" style="display: none" />

            <table cellspacing="0" cellpadding="0" width="800" border="0">
                <tr>
                    <td colspan="5" height="102" valign="bottom" background="images/index7_01_1_1.gif">
                        <table width="100%" border="0" cellpadding="0">
                            <tr>
                                <td height="25">
                                    <table width="100%" border="0" cellpadding="0" cellspacing="0">
                                        <tr>
                                            <td width="8%">&nbsp;
                                            </td>
                                            <td width="3%" valign="middle">
                                                <div align="center">
                                                    <img src="images/dot.gif" width="10" height="10" />
                                                </div>
                                            </td>
                                            <td width="9%" class="link4">
                                                <a href="https://www.ntuh.gov.tw" target="_blank">院外網</a>
                                            </td>
                                            <td width="2%" valign="middle">
                                                <div align="center">
                                                    <img src="images/dot.gif" alt="" width="10" height="10" />
                                                </div>
                                            </td>
                                            <td width="9%" class="link4">
                                                <a href="https://ntuhgovtw.sharepoint.com/sites/intra" target="_blank">院內網</a>
                                            </td>
                                            <td width="2%" valign="middle">
                                                <div align="center">
                                                    <img src="images/dot.gif" alt="" width="10" height="10" />
                                                </div>
                                            </td>
                                            <td width="15%" class="link4">
                                                <a href="https://intra.ntuh.gov.tw/default.aspx" target="_blank">舊院內網(僅供查閱)</a>
                                            </td>
                                            <td width="1%" valign="middle">&nbsp;
                                            </td>
                                            <td width="46%" class="link4">&nbsp;
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td width="94%" height="30" valign="top">
                                    <div class="link4">
                                        <div id="navi" style="margin-left: 430px;">
                                            <ul>
                                                <li>
                                                    <a href="https://edu.ntuh.gov.tw/" target="_blank">
                                                        <img src="images/arrow.gif" alt=" " width="5" height="5" vspace="0" style="border: 0px;" />數位學習 </a>
                                                </li>

                                                <li>

                                                    <a href="https://km.ntuh.gov.tw/km" target="_blank">
                                                        <img src="images/arrow.gif" alt=" " width="5" height="5" vspace="2" style="border: 0px;" />KM系統 </a>
                                                </li>

                                                <li class="parent" onmouseover="this.className='parentOn'" onmouseout="this.className='parent'">

                                                    <a href="https://eip.ntuh.gov.tw/EIP/" target="_blank" visible="false">
                                                        <img src="images/arrow.gif" alt=" " width="5" height="5" vspace="2" style="border: 0px;" />差勤系統 </a>
                                                    <ul>
                                                        <li><a href="https://eip.ntuh.gov.tw/EIP/" target="_blank">總院差勤 </a></li><li><a href="http://eip.ntucc.gov.tw/EIP/" target="_blank">癌醫差勤 </a></li><li><a href="http://bheip.ntuh.gov.tw/EIP/" target="_blank">北護差勤 </a></li><li><a href="http://yleip.ntuh.gov.tw/EIP/" target="_blank">雲林差勤 </a></li><li><a href="http://jseip.ntuh.gov.tw/EIP/" target="_blank">金山差勤 </a></li><li><a href="https://hbioeip.ntuh.gov.tw/EIP/" target="_blank">新竹臺大差勤 </a></li>
                                                    </ul>

                                                </li>

                                                <li>

                                                    <a href="https://ntuhgovtw.sharepoint.com/sites/intra.doc/Lists/form/AllItems.aspx"
                                                        target="_blank">
                                                        <img src="images/arrow.gif" width="5" height="5" vspace="2" style="border: 0px;" />表單下載</a>
                                                </li>

                                                <li>

                                                    <a href="https://reg.ntuh.gov.tw/"
                                                        target="_blank">
                                                        <img src="images/arrow.gif" width="5" height="5" vspace="2" style="border: 0px;" />網路掛號</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                                <td width="6%">&nbsp;
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td valign="top" width="39" background="images/design6_1_1.gif">
                        <img height="129" src="images/design6_1.gif" width="39">
                    </td>
                    <td valign="top" width="380" bgcolor="#e7e1c1" rowspan="2" style="height: 424px">
                        <table cellspacing="0" cellpadding="0" width="100%" border="0">
                            <tr>
                                <td width="385" valign="top">
                                    <img height="129" src="images/design6_2.gif" width="384">
                                </td>
                            </tr>
                        </table>
                        <br>
                        <table width="383" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td>
                                    <img width="385" height="221" src="images/building.gif" />
                                </td>
                            </tr>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td height="41">
                                    <iframe width="383px" height="40px" frameborder="0" scrolling="no" src="https://intra.ntuh.gov.tw/news/document/staff_message.htm"></iframe>
                                </td>
                            </tr>
                        </table>
                        <table width="100%" border="0" cellspacing="10" cellpadding="0">
                            <tr>
                                <td height="40" colspan="3"></td>
                            </tr>
                            <tr>
                                <td>
                                    <img id="ImageAPPDownLoadBarCode" src="" style="border-width:0px;" />
                                </td>
                                <td>
                                    </td>
                                <td>
                                    </td>
                            </tr>
                        </table>
                        <br />
                    </td>
                    <td valign="top" width="46" background="images/design6_3_1.gif">
                        <img height="128" src="images/index7_03.gif" width="46" />
                    </td>
                    <td valign="top" width="286" bgcolor="#ffffff" rowspan="2" style="height: 424px">
                        <table height="300" cellspacing="0" cellpadding="0" width="100%" bgcolor="#ffffff"
                            border="0">
                            <tr>
                                <td valign="top" height="54">
                                    <div class="LogIn" align="center">
                                        
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td valign="top">
                                    <div align="center">
                                        <table cellspacing="0" cellpadding="4" width="250" align="center" border="0">
                                            <tr>
                                                <td class="LogIn" align="right">院區
                                                </td>
                                                <td align="left">
                                                    <select name="ddlHospital" onchange="javascript:setTimeout(&#39;__doPostBack(\&#39;ddlHospital\&#39;,\&#39;\&#39;)&#39;, 0)" id="ddlHospital" tabindex="96" class="LogIn" designtimedragdrop="101">
	<option selected="selected" value="T0">總院區</option>
	<option value="C0">癌醫中心分院</option>
	<option value="T2">北護分院</option>
	<option value="T3">金山分院</option>
	<option value="T7">新竹臺大分院(含生醫醫院)</option>
	<option value="T4">新竹醫院</option>
	<option value="Y0">雲林分院</option>
	<option value="T5">竹東分院(舊)</option>
	<option value="T6">生醫分院(舊)</option>

</select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="LogIn" width="49" align="right">帳號
                                                </td>
                                                <td width="181" align="left">
                                                    <input name="txtUserID" type="text" id="txtUserID" autocomplete="off" onkeydown="moveToLogin(event);" style="width:115px;ime-mode: disabled" />
                                                </td>
                                            </tr>
                                            
                                            <tr id="tr_o">
	<td class="LogIn" align="right">OTP 碼
                                                </td>
	<td align="left">
                                                    <input type="text" maxlength="6" id="tb_otp" autocomplete="off" style="width: 115px;" />
                                                </td>
</tr>

                                            <tr id="tr_p_1">
	<td class="LogIn" align="right">密碼
                                                </td>
	<td align="left">
                                                    <input name="txtPass" type="password" id="txtPass" onkeypress="detectCapsLock(event);" autocomplete="off" style="width:115px;" />
                                                    <div id="capStatus" style="visibility: hidden">
                                                        <font color="red" size="2">大寫鍵(CapsLock)已開啟</font>
                                                    </div>
                                                </td>
</tr>

                                            <tr id="tr_p_2" valign="middle">
	<td colspan="2" class="LogIn">
                                                    <div>
                                                        <span id="lblVerifyMsg">驗證碼</span>
                                                        <span id="Label1" style="color:Blue;">(不用區分大小寫)</span>
                                                        <br />
                                                        <img id="imgVerifyCode" src="VerifyImgHandler.ashx?verifyCode=cgBlAGcAcgA0AEoATgAyAGQAeQBmADUAVQBxAGsANQBEAHMAUQA5AFcAdwA9AD0A0" style="border-width:0px;" />
                                                        <input type="image" name="ibnRegenVerifyImg" id="ibnRegenVerifyImg" tabindex="99" title="重新產生驗證碼" src="images/today.gif" alt="重新產生驗證碼" style="border-width:0px;" />
                                                        
                                                        
                                                    </div>
                                                </td>
</tr>

                                            <tr id="tr_p_3">
	<td colspan="2" align="center">
                                                    <input name="txtVerifyCode" type="text" id="txtVerifyCode" onkeydown="moveToLogin(event)" autocomplete="off" style="width:115px;ime-mode: disabled" />
                                                </td>
</tr>

                                            <tr>
                                                <td class="LogIn" align="right">登入系統
                                                </td>
                                                <td align="left">
                                                    <font face="新細明體">
                                                        <table id="rdblQuickMenu" class="En11" border="0" style="width:164px;">
	<tr>
		<td><input id="rdblQuickMenu_0" type="radio" name="rdblQuickMenu" value="H" checked="checked" tabindex="97" /><label for="rdblQuickMenu_0">醫療相關選單</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_1" type="radio" name="rdblQuickMenu" value="A" tabindex="97" /><label for="rdblQuickMenu_1">行政系統選單</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_2" type="radio" name="rdblQuickMenu" value="O" tabindex="97" /><label for="rdblQuickMenu_2">門診系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_3" type="radio" name="rdblQuickMenu" value="I" tabindex="97" /><label for="rdblQuickMenu_3">住院系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_4" type="radio" name="rdblQuickMenu" value="E" tabindex="97" /><label for="rdblQuickMenu_4">急診系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_5" type="radio" name="rdblQuickMenu" value="N" tabindex="97" /><label for="rdblQuickMenu_5">護理系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_6" type="radio" name="rdblQuickMenu" value="OP" tabindex="97" /><label for="rdblQuickMenu_6">手術系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_7" type="radio" name="rdblQuickMenu" value="NP" tabindex="97" /><label for="rdblQuickMenu_7">PACS系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_8" type="radio" name="rdblQuickMenu" value="P" tabindex="97" /><label for="rdblQuickMenu_8">PACS備用系統</label></td>
	</tr><tr>
		<td><input id="rdblQuickMenu_9" type="radio" name="rdblQuickMenu" value="W" tabindex="97" /><label for="rdblQuickMenu_9">未完成病歷</label></td>
	</tr>
</table>
                                                    </font>
                                                </td>
                                            </tr>
                                            <tr valign="middle">
                                                <td colspan="2" height="50">
                                                    <div class="LogIn" align="center">
                                                        <table cellspacing="0" cellpadding="0" border="0">
                                                            <tr align="center" valign="middle">
                                                                <td width="200" align="center">
                                                                    <input type="submit" name="imgBtnSubmitNew" value="" id="imgBtnSubmitNew" accesskey="L" class="btn" style="height:30px;width:75px;" />
                                                                    <button type="button" id="b_verify" class="btn" style="height: 30px; width: 75px;"></button>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                        <span id="lblMessage" class="note_red"></span>
                                                        <br />
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </td>
                    <td valign="top" width="45" background="images/index7_05.gif" rowspan="2" style="height: 424px">
                        <div align="right">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td background="images/design6_1_1.gif" style="height: 61px"></td>
                    <td valign="top" width="46" background="images/design6_3_1.gif" style="height: 61px"></td>
                </tr>
                <tr valign="top">
                    <td background="images/design6_1_1.gif" bgcolor="#e7e1c1">&nbsp;
                    </td>
                    <td colspan="3" bgcolor="#d1cda2">
                        <br>
                        <table width="680" border="0" align="center" cellpadding="8" cellspacing="0" bgcolor="#e5e3d1">
                            <tr>
                                <td>
                                    <div align="left">
                                        <a id="ComputerUniversalGen" href="javascript:__doPostBack(&#39;ComputerUniversalGen&#39;,&#39;&#39;)" style="color:DarkRed;font-size:Small;">注意事項說明:</a>
                                        <a id="iOSDownLoadBarCodeGen" href="javascript:__doPostBack(&#39;iOSDownLoadBarCodeGen&#39;,&#39;&#39;)" style="color:DarkRed;font-size:Small;">iOS APP下載二維條碼</a>
                                        <div>
	<table cellspacing="0" cellpadding="2" border="0" id="BeforeLoginNotify" style="color:Black;background-color:LightGoldenrodYellow;border-color:Tan;border-width:1px;border-style:solid;width:100%;border-collapse:collapse;">
		<tr>
			<td style="width:5%;">
                                                        <span id="BeforeLoginNotify_ctl02_LabelNumber" class="En11">1.</span>
                                                    </td><td>
                                                        <span id="BeforeLoginNotify_ctl02_LabelDesc" class="En11">兼任醫師及代訓醫師需經報備後，方可執行看診作業。若有問題請洽人事室(261573)及教學部(267524)</span>
                                                    </td>
		</tr><tr style="background-color:PaleGoldenrod;">
			<td style="width:5%;">
                                                        <span id="BeforeLoginNotify_ctl03_LabelNumber" class="En11">2.</span>
                                                    </td><td>
                                                        <span id="BeforeLoginNotify_ctl03_LabelDesc" class="En11">其他相關登入問題，請洽總院資訊服務台(261120)</span>
                                                    </td>
		</tr>
	</table>
</div>
                                    </div>
                                </td>
                            </tr>
                        </table>
                        <br>
                    </td>
                    <td background="images/index7_05.gif" bgcolor="#e7e1c1">&nbsp;
                    </td>
                </tr>
                <tr valign="top">
                    <td colspan="5">
                        <img height="32" src="images/frame_bottom.gif" width="800" />
                    </td>
                </tr>
                <tr valign="top">
                    <td background="images/design6_address.gif" colspan="5" height="77">
                        <div align="center">
                            <font face="新細明體"></font>
                            <table cellspacing="0" cellpadding="0" align="center" border="0">
                                <tr>
                                    <td height="20">
                                        <div align="center">
                                            <span class="maintain">
                                                <br />
                                                National Taiwan University Hospital - No.7, Chung San South Road, Taipei City 100, Taiwan (R.O.C.) TEL: 886-2-23123456
                                            </span>
                                        </div>
                                        <div align="center" style="height: 20px">
                                            <span class="maintain">
                                                國 立 臺 灣 大 學 醫 學 院 附 設 醫 院 - 台北市中山南路7號
                                            </span>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>
            
        </div>
    
<script>document.getElementById('txtUserID').focus();</script><script language='javascript' src='scripts/md5.js'></script>
<script type="text/javascript">
//<![CDATA[
InitInPatientConsentQuickMenu();(function() {var fn = function() {$get("ScriptManager1_HiddenField").value = '';Sys.Application.remove_init(fn);};Sys.Application.add_init(fn);})();//]]>
</script>
</form>
    <script type="text/javascript">
        $(document).ready(function () {
            $(document).on("change", "#ddlHospital", function (_event) {
                init();

                //    $("#ddl_verification").val("P");
                //    $("#tr_o").hide();
                //    $("#tr_p_1").hide();
                //    $("#tr_p_2").hide();
                //    $("#tr_p_3").hide();
                //    $("#b_verify").hide();
                //    $("#imgBtnSubmitNew").show();
            });

            $(document).on("change", "#ddl_verification", function (_event) {
                let _value = $(this).val();
                $.cookie.set({ key: "VerificationValue", value: _value });
                $("#tr_o").hide();
                $("#tr_p_1").hide();
                $("#tr_p_2").hide();
                $("#tr_p_3").hide();
                $("#b_verify").hide();
                $("#imgBtnSubmitNew").hide();
                $("#a_fido").show();
                $("#a_teaching").show();

                switch (_value) {
                    // Fido
                    case "F":
                        $("#b_verify").show();
                        break;
                    // OTP
                    case "O":
                        $("#tr_o").show();
                        $("#b_verify").show();
                        break;
                    // 密碼
                    case "P":
                        $("#tr_p_1").show();
                        $("#tr_p_2").show();
                        $("#tr_p_3").show();
                        $("#imgBtnSubmitNew").show();
                        $("#a_fido").hide();
                        $("#a_teaching").hide();
                        break;
                }
            });

            $(document).on("keydown", "#tb_otp", function (_event) {
                let _code = (_event.keyCode ? _event.keyCode : _event.which);
                if (_code === 13) {
                    $("#b_verify").trigger("click");
                    return false;
                }
            });

            $(document).on("keydown", "#txtUserID", function (_event) {
                let _code = (_event.keyCode ? _event.keyCode : _event.which);
                let _verification = ($("#ddl_verification").val() || "P").trim().toUpperCase();

                switch (_code) {
                    case 9:
                        switch (_verification) {
                            case "P":
                                document.getElementById('txtPass').focus();
                                return false;
                            case "O":
                                document.getElementById('tb_otp').focus();
                                return false;
                        }
                    case 13:
                        switch (_verification) {
                            case "F":
                                $("#b_verify").trigger("click");
                                return false;
                            case "O":
                                $("#tb_otp").select();
                                $("#tb_otp").focus();
                                return false;
                        }
                        break;
                }
            });

            $(document).on("click", "#b_verify", function (_event) {
                let _verification = $("#ddl_verification").val() || "P";
                let _loginid = $("#txtUserID").val().trim().toUpperCase();

                $("#txtPass").val("");

                if (_loginid === "") {
                    $("#txtUserID").focus();
                    return alert("帳號未輸入，請確認！");
                }

                _loginid = _loginid.padStart(6, "0");

                switch (_verification.trim().toUpperCase()) {
                    case "F":
                        $.login.fidokey({ name: _loginid })
                            .then(function (_f_ack) {
                                console.log("ack:" + JSON.stringify(_f_ack));
                                if (_f_ack.success === true) {
                                    $("#txtPass").val(_f_ack.md5);
                                    $("#imgBtnSubmitNew").trigger("click");
                                }
                                else
                                    $("#lblMessage").text(_f_ack.error);
                            });

                        break;
                    case "O":
                        let _credential = $("#tb_otp").val().trim();
                        if (_credential === "") {
                            $("#tb_otp").focus();
                            return alert("OTP 驗證碼未輸入，請確認！");
                        }

                        let _o_ack = $.login.otp({
                            "name": _loginid,
                            "credential": _credential
                        });
                        if (_o_ack.success === true) {
                            $("#txtPass").val(_o_ack.md5);
                            $("#imgBtnSubmitNew").trigger("click");
                        }
                        else
                            $("#lblMessage").text(_o_ack.error);

                        break;
                }

                return false;
            });

            $(document).on("click", "#imgBtnSubmitNew", function (_event) {
                if (chk()) {
                    if (($("#ddl_verification").val() || "P") === "P")
                        handleLogin();
                }
                else
                    return false;
            });

            init();
        });

        function init() {
            $("#tr_o").hide();
            $("#tr_p_1").show();
            $("#tr_p_2").show();
            $("#tr_p_3").show();
            $("#b_verify").hide();
            $("#imgBtnSubmitNew").show();
            $("#txtUserID").val("");
            $("#txtVerifyCode").val("");

            if ($("#ddl_verification").length > 0 && $("#tr_verification").length > 0) {
                $("#tb_otp").val("");
                let _verification_value = $.cookie.read({ key: "VerificationValue" }) || "P";
                $("#ddl_verification").val(_verification_value);
                $("#ddl_verification").trigger("change");
            }
        }

        function chk() {
            if (document.getElementById('txtUserID').value.length == 0) {
                alert('請輸入帳號');
                document.getElementById('txtUserID').focus();
                return false;
            }

            if (document.getElementById('txtUserID').value.length > 6) {
                alert('請檢查帳號是否輸入錯誤');
                document.getElementById('txtUserID').focus();
                return false;
            }

            let _verification = $("#ddl_verification").val() || "P";

            switch (_verification.trim().toUpperCase()) {
                case "F":
                    break;
                case "O":
                    if ($("#tb_otp").val().trim() === "") {
                        alert("請輸入OTP 驗證碼");
                        document.getElementById("tb_otp").focus();
                        return false;
                    }
                    break;
                case "P":
                    if (document.getElementById('txtPass').value.length == 0) {
                        alert('請輸入密碼');
                        document.getElementById('txtPass').focus();
                        return false;
                    }

                    if (document.getElementById('txtVerifyCode').value.length == 0) {
                        alert('請輸入驗證碼');
                        document.getElementById('txtVerifyCode').focus();
                        return false;
                    }
                    break;
            }

            return true;
        }

        function handleLogin() {
            //sendMD5Value(calculateMD5Value());
            CheckAndSetPassTextBox('txtPass');
            //CheckAndSetPassTextBox('txbNewPass1');
            //CheckAndSetPassTextBox('txbNewPass2');
        }

        function calculateMD5Value() {
            var pw = document.forms['Form1'].elements['txtPass'].value;
            return hex_md5(pw);
        }

        function sendMD5Value(hash) {
            document.forms['Form1'].elements['txtPass'].value = hash;
        }

        function CheckAndSetPassTextBox(textboxID) {
            if (document.getElementById(textboxID) != null) {
                document.getElementById(textboxID).value = hex_md5(document.getElementById(textboxID).value);
            }
        }
    </script>
</body>
</html>
